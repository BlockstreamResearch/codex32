10 dict begin
    72 720 moveto
    /Helvetica findfont 20 scalefont setfont
    gsave (Constructing Shares) show grestore
    0 -20 rmoveto
    /Times-Roman findfont 12 scalefont setfont
    468 12
    [ [
    (Before constructing shares, you must choose your threshold value k, which is the number of)
    (shares needed to reconstruct the secret, and must be between 2 and 31 inclusive. \(k = 1 can be)
    (achieved by simply duplicating the original secret, and k > 31 is mathematically impossible with)
    (this scheme.\) Be aware that the work required during recovery is quadratic in k, so values greater)
    (than 4 are not recommended. You also cannot generate more than 31 shares total.)
    ] [
    (Next, generate the "S" share, which is the unshared secret, as well as k - 1 more shares with)
    (consecutive indices starting from "A". These initial shares should be generated randomly using)
    (dice, affixed with a header, then checksummed. See the Dice Table page and the Checksum)
    (Worksheet for more details.)
    ] [
    (For the case k = 2, you will have only two shares, S and A, and there is a simplified method)
    (available to generate the remaining shares. Use each character from your S share to select a table)
    (from the following pages. Look up the row indexed by the corresponding character of your A)
    (share, then read the corresponding character for the C share from the first column. The character)
    (for the D share will be in the column after that, and so on.)
    ] ] showParagraphs
    [
    (The general scheme is more involved:)
    (    1. Choose the appropriate table from this page based on your choice of k.)
    (    2. Find the column corresponding to the share you wish to create.)
    (    3. Translate each initial share by its symbol from that column, using the Translation Wheel.)
    (    4. Add all the translated initial shares together using the Addition Wheel.)
    ()
    (Tables for higher k can be easily generated by editing the source code of this file.)
    ]
    { gsave show grestore 0 -12 rmoveto } forall

    % EDITME
    % Edit these values to draw tables for larger k. Be warned that the total work to recover
    % a secret from k shares will be on the other of (48 + k - 1)k volvelle applications. For
    % k = 8 this is already over 250. And this is not even considering the logistics of keeping
    % eight distributed shares intact and available..
    /mink 2 def
    /maxk 6 def

    /x 104 def
    /y 400 def
    /rowtitle 6 string def
    mink 1 maxk {
        /k exch def

        0 1 k {
            /rowidx exch def
            x y moveto
            /Courier-Bold findfont 12 scalefont setfont
            rowidx 0 eq {
                % First row (heading)
                k (k =   ) rowtitle copy 4 2 getinterval cvs pop
                rowtitle show

                k mink sub { 12 0 rmoveto } repeat
                k 1 31 {
                    permS exch get code exch get gsave glyphshow grestore
                    12 0 rmoveto
                } for % horizontal loop
            } {
                % Symbol rows
                /xinterp rowidx 1 sub def % x coord to interpolate at
                (  ) show
                permS xinterp get code exch get glyphshow
                (   ) show

                k mink sub { 12 0 rmoveto } repeat
                k 1 31 {
                    permS exch get  % x coord to evaluate at
                    permS xinterp get % x coord to interpolate at
                    permS 0 k getinterval % x coords to interpolate at
                    lagrange % symbol
                    code2 exch get gsave 12 codexshow grestore % print symbol
                    12 0 rmoveto
                } for % horizontal loop
            } ifelse


            /y y 11 sub def
        } for % vertical loop

        /y y 20 sub def
    } for

end
